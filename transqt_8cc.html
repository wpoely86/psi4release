<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>PSI: transqt.cc File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PSI
   &#160;<span id="projectnumber">4.0.0-beta5</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_031c4fc26031de218e3c67acfca35073.html">bin</a></li><li class="navelem"><a class="el" href="dir_3304c856a1232bb5b33adc58da800fe7.html">transqt</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">transqt.cc File Reference<div class="ingroups"><a class="el" href="group__TRANSQT.html">transqt: Integral Transformation Program</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>The SO-to-MO integral transformation program.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;cmath&gt;</code><br/>
<code>#include &lt;cstdio&gt;</code><br/>
<code>#include &lt;cstdlib&gt;</code><br/>
<code>#include &lt;cstring&gt;</code><br/>
<code>#include &lt;libpsio/psio.h&gt;</code><br/>
<code>#include &lt;libciomr/libciomr.h&gt;</code><br/>
<code>#include &lt;libchkpt/chkpt.h&gt;</code><br/>
<code>#include &lt;libmints/wavefunction.h&gt;</code><br/>
<code>#include &lt;<a class="el" href="qt_8h_source.html">libqt/qt.h</a>&gt;</code><br/>
<code>#include &lt;libiwl/iwl.h&gt;</code><br/>
<code>#include &lt;psifiles.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="transqt_2MOInfo_8h_source.html">MOInfo.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="transqt_2Params_8h_source.html">Params.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="transqt_2globals_8h_source.html">globals.h</a>&quot;</code><br/>
<code>#include &quot;psi4-dec.h&quot;</code><br/>
<code>#include &lt;libmints/basisset.h&gt;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for transqt.cc:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="transqt_8cc__incl.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:namespacepsi"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepsi.html">psi</a></td></tr>
<tr class="memdesc:namespacepsi"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a set of vectors around an arbitrary axis Vectors are rows of input matrix. <br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a14b0c5fc58f3a91a399fe7b7a3eefcd1"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a14b0c5fc58f3a91a399fe7b7a3eefcd1"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>IOFF_MAX</b>&#160;&#160;&#160;32641</td></tr>
<tr class="separator:a14b0c5fc58f3a91a399fe7b7a3eefcd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aff636f67a9ca6dac60d3af9b7c5470d0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><b>psi::transqt::semicanonical_fock</b> (int averaged)</td></tr>
<tr class="separator:aff636f67a9ca6dac60d3af9b7c5470d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12997180d61b3e34176db4413e08da61"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a12997180d61b3e34176db4413e08da61"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>psi::transqt::transform_one</b> ()</td></tr>
<tr class="separator:a12997180d61b3e34176db4413e08da61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbd8cf3ca3ef7eeee0841134af733b15"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><b>psi::transqt::transform_two</b> (void)</td></tr>
<tr class="separator:acbd8cf3ca3ef7eeee0841134af733b15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1f92d171197ff5f72ecfd92a3896ce7"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac1f92d171197ff5f72ecfd92a3896ce7"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>psi::transqt::cleanup</b> (void)</td></tr>
<tr class="separator:ac1f92d171197ff5f72ecfd92a3896ce7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca7a43400493e06c5a01a9a3ca6c5347"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aca7a43400493e06c5a01a9a3ca6c5347"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>psi::transqt::fzc_density</b> (int nirreps, int *docc, double *Pc, double **C, int *first, int *first_so, int *last_so, int *ioff)</td></tr>
<tr class="separator:aca7a43400493e06c5a01a9a3ca6c5347"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe456bdd9298f4b601eb5626881b1d01"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abe456bdd9298f4b601eb5626881b1d01"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>psi::transqt::ivo_density</b> (int nirreps, int *fzdocc, int *docc, int *socc, double *P, double **C, int *first, int *first_so, int *last_so, int *ioff)</td></tr>
<tr class="separator:abe456bdd9298f4b601eb5626881b1d01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a221ee8016d63af6567786676eb4e790a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><b>psi::transqt::transform_two_mp2</b> (void)</td></tr>
<tr class="separator:a221ee8016d63af6567786676eb4e790a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcd313f637b2def85d04d683cf84ef40"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><b>psi::transqt::transform_two_mp2r12a_t</b> (void)</td></tr>
<tr class="separator:adcd313f637b2def85d04d683cf84ef40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c9f13cb2aab591094cb9297883e9997"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><b>psi::transqt::transform_two_mp2r12a_gr</b> (void)</td></tr>
<tr class="separator:a7c9f13cb2aab591094cb9297883e9997"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa82588befb16d201d6e38206bc544389"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa82588befb16d201d6e38206bc544389"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>psi::transqt::init_io</b> (Options &amp;options)</td></tr>
<tr class="separator:aa82588befb16d201d6e38206bc544389"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3511e5957398aafbd1f912ba9a689479"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3511e5957398aafbd1f912ba9a689479"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>psi::transqt::title</b> (void)</td></tr>
<tr class="separator:a3511e5957398aafbd1f912ba9a689479"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76f011bb0700b2e1d00a62ef78eefc54"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a76f011bb0700b2e1d00a62ef78eefc54"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>psi::transqt::init_ioff</b> (void)</td></tr>
<tr class="separator:a76f011bb0700b2e1d00a62ef78eefc54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45749a809fe3a4e0184ee8554fb91718"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a45749a809fe3a4e0184ee8554fb91718"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>psi::transqt::get_parameters</b> (Options &amp;options)</td></tr>
<tr class="separator:a45749a809fe3a4e0184ee8554fb91718"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0d29f09e38cb594ff55d2d8b6a0cdb1"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae0d29f09e38cb594ff55d2d8b6a0cdb1"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>psi::transqt::print_parameters</b> (void)</td></tr>
<tr class="separator:ae0d29f09e38cb594ff55d2d8b6a0cdb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2f2d736cd1bf4349d75641b0c4f68db"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa2f2d736cd1bf4349d75641b0c4f68db"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>psi::transqt::get_moinfo</b> (Options &amp;options)</td></tr>
<tr class="separator:aa2f2d736cd1bf4349d75641b0c4f68db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67821da53d1f2e2bcf33c297cf55ef14"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a67821da53d1f2e2bcf33c297cf55ef14"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>psi::transqt::get_one_electron_integrals</b> (void)</td></tr>
<tr class="separator:a67821da53d1f2e2bcf33c297cf55ef14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31e8c6b1d4de34c3ca4ac5249a643310"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a31e8c6b1d4de34c3ca4ac5249a643310"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>psi::transqt::exit_io</b> ()</td></tr>
<tr class="separator:a31e8c6b1d4de34c3ca4ac5249a643310"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31670f7fb7074382eb68a7b74d7ce89c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a31670f7fb7074382eb68a7b74d7ce89c"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>psi::transqt::get_reorder_array</b> (Options &amp;options)</td></tr>
<tr class="separator:a31670f7fb7074382eb68a7b74d7ce89c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5da49fdfcb0a6e3203fc5131e479aa8"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa5da49fdfcb0a6e3203fc5131e479aa8"></a>
double ***&#160;</td><td class="memItemRight" valign="bottom"><b>psi::transqt::construct_evects</b> (const char *spin, int nirreps, int *active, int *sopi, int *orbspi, int *first_so, int *last_so, int *first, int *last, int *fstact, int *lstact, int printflag)</td></tr>
<tr class="separator:aa5da49fdfcb0a6e3203fc5131e479aa8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54ffcc8a4134134bb63eb8545d63e115"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a54ffcc8a4134134bb63eb8545d63e115"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>psi::transqt::destruct_evects</b> (int nirreps, double ***evects)</td></tr>
<tr class="separator:a54ffcc8a4134134bb63eb8545d63e115"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae537f0c9818cca920bb365f1a1509aea"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae537f0c9818cca920bb365f1a1509aea"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>psi::transqt::check_C</b> (int nso, int nmo, double **Cmat, double *S)</td></tr>
<tr class="separator:ae537f0c9818cca920bb365f1a1509aea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbbab2c3bf2476ade441690bfba0a36c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="adbbab2c3bf2476ade441690bfba0a36c"></a>
PsiReturnType&#160;</td><td class="memItemRight" valign="bottom"><b>psi::transqt::transqt</b> (Options &amp;)</td></tr>
<tr class="separator:adbbab2c3bf2476ade441690bfba0a36c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The SO-to-MO integral transformation program. </p>
<p>Program to transform one- and two-electron integrals over symmetry-orbitals to integrals over molecular orbitals.</p>
<p>The original version of TRANSQT was based on the Saunders/van Lenthe algorithm, which should have been very fast, but adding the symmetry restrictions made the code so complicated that we couldn't figure out how to formulate the innermost loops as fast vector algorithms without a lot of trouble.</p>
<p>This transformation is a straight "four single-index transformations" algorithm, modified to use matrix multiplications for each step. Each half of the transformation is done with two consecutive matrix multiplications for each value of indices pq (or kl in the second half). This actually does more work then the Elbert algorithm because it doesn't take full advantage of the permutational symmetry of the integrals, but should run faster on superscalar or vector processors with a well-written matrix multiplication algorithm. We currently use <a class="el" href="group__CIOMR.html#gafcab75421c56def41337f3b0d7efe502">mmult()</a> written by Ed Seidl for the DEC3100. It would be worthwhile to re-write these routines at a later date with more loops unrolled. In addition, it should be possible to insert any highly-optimized matrix-multiplication routine in order to obtain peak performance. Such a routine could even be FORTRAN-based, since the main arrays used here are constructed using <a class="el" href="group__CIOMR.html#ga5342d96a20702d84857440badc8be2ec">block_matrix()</a>.</p>
<p>This version uses symmetry simplifications for D2h and its subgroups, and runs out-of-core within the main loops. The input list of integrals from file33 is presorted via a Yoshimine sort into all rs for a given pq. This list is then half-transformed. The resulting integrals are then sorted to all pq for a given kl. This list is then transformed completely. The final integrals are currently written as all ij for a given kl to file92 as an iwl buffer. TDC 5/17/95</p>
<p>In addition, this version excludes frozen core and virtual orbitals from the transformation. While this should cut back significantly on the computational expense, it does mean that changes to the active orbitals requires a complete re-transformation. TDC 9/19/95</p>
<p>A restricted transformation which produces integrals of the type (ov|ov) where o=occupied and v=virtual has been included. This is useful primarily for MP2 energy codes. A separate routine, transform_two_mp2() has been added to simplify the structure of transform_two() somewhat. TDC 9/26/95</p>
<p>Code updated with more even more of the options available in the Saunders-van Lenthe version of TRANSQT. Output files are no longer hardwired, the one-electron integrals are output with the <a class="el" href="group__IWL.html#gabe5a0cef49daf49b3df5d3cc2d1a3a3d">iwl_wrtone()</a> function, implicit frozen core is treated properly (i.e. "FZC" orbitals), and restricted core transformations (i.e. "COR" orbitals) are also possible. CDS 10/6/95</p>
<p>The COR orbitals stuff somehow got broken; fixed that, added the -quiet command-line option, and got the RAS reordering array in a much nicer way. CDS 6/26/96</p>
<p>Finished a backtransformation routine that runs in C1 symmetry by folding the AO/SO transform into C. CDS 1/30/98</p>
<p>More work done to clean up and generalize the code for forwards and backwards transformations. Removed (or at least commented out) the evil hardwiring of moinfo.first, moinfo.last, etc, that I did last time for backtransforms. Now there are backtransform-specific entries in moinfo. Additionally, the code is able to handle all conceivable combinations of frozen core/frozen virtuals, and it knows to ignore these keywords and transform all integrals in the case of gradients or MCSCF type procedures. Currently we assume that the one and twopdm's have frozen core indices but no frozen virt indices, whereas the Lagrangian has all indices. CDS 3/18/98</p>
<p>Yet more work to streamline the one-electron integral transformations. The code in transform_one() had gotten messy with so many possible cases. Now we always run over all orbitals (including frozen core and virtuals) when writing out the MO one-electron ints. Frozen orbitals can be filtered out when reading with the new iwl rdone() function. We reserve one file for bare one-electron ints, and another for the frozen core operator (one-electron ints are dressed with two-elec ints involving frozen core orbitals). Made file numbering for exported files use the new <a class="el" href="psifiles_8h_source.html">psifiles.h</a> macros...no more hardwiring the numbers. CDS 4/29/98</p>
<p>Added transformation routines necessary for MP2-R12 in standard approximation A. I decided to use command line options to pass necessary information to TRANSQT. See transqt.1 for an explanation. Had to add two new transform_two_ functions, to transform regular integrals, like ERIs and integrals over r12, which have bra-ket symmetry, and pesky [r12,T1] integrals which do not only have bra-ket symmetry but are also anti-symmetric with respect to a permutation of the first two indices. The required transformation is a partial 4-index transformation of OGOG type (2 indices refer to occupied orbitals and two are general indices). Had to add a function to properly write half-(yosh_write_arr_mp2r12a) and fully-transformed integrals (iwl_buf_wrt_arr_mp2r12a in LIBIWL) to IWL buffers. Remember that the occupied indices are in QTS order and the general indices are in Pitzer order. Sad but true. EFV 08/05/99</p>
<p>Added forward and backward transformations for UHF cases. TDC, 03</p>
<p>Daniel Crawford, David Sherrill, and Justin Fermann Center for Computational Quantum Chemistry University of Georgia </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.3.1
</small></address>
</body>
</html>
