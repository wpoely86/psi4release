<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>PSI: sieve.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PSI
   &#160;<span id="projectnumber">4.0.0-beta5</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_c85d3e3c5052e9ad9ce18c6863244a25.html">lib</a></li><li class="navelem"><a class="el" href="dir_732ea31350aa9d9b1d75f535925ca4d3.html">libmints</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">sieve.h</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#ifndef SIEVE_H </span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define SIEVE_H</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// need this for erfc^{-1} in the QQR sieve</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;boost/math/special_functions/erf.hpp&gt;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;cfloat&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="keyword">namespace </span>boost {</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; <span class="keyword">class </span>shared_ptr;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;}</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="keyword">namespace </span>psi {</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="keyword">class </span>BasisSet;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="keyword">class </span>TwoBodyAOInt;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div>
<div class="line"><a name="l00068"></a><span class="lineno"><a class="code" href="classpsi_1_1ERISieve.html">   68</a></span>&#160;<span class="keyword">class </span><a class="code" href="classpsi_1_1ERISieve.html">ERISieve</a> {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="code" href="classpsi_1_1ERISieve.html#a6562cc656efee5e3e425e716a465dc2f">   73</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classpsi_1_1ERISieve.html#a6562cc656efee5e3e425e716a465dc2f" title="Debug flag (defaults to 0)">debug_</a>;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="code" href="classpsi_1_1ERISieve.html#aa3a78600573af4ecf9e2472b21968bcb">   76</a></span>&#160;    <a class="code" href="classboost_1_1shared__ptr.html">boost::shared_ptr&lt;BasisSet&gt;</a> <a class="code" href="classpsi_1_1ERISieve.html#aa3a78600573af4ecf9e2472b21968bcb" title="Basis set reference.">primary_</a>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="code" href="classpsi_1_1ERISieve.html#abb4ad4e31527d67a222dd75672d6bb40">   79</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classpsi_1_1ERISieve.html#abb4ad4e31527d67a222dd75672d6bb40" title="Number of basis functions.">nbf_</a>;</div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="code" href="classpsi_1_1ERISieve.html#a928519e724dc0980da488a1615ced773">   81</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classpsi_1_1ERISieve.html#a928519e724dc0980da488a1615ced773" title="Number of shells.">nshell_</a>;    </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="code" href="classpsi_1_1ERISieve.html#ac065dcc75f79500d816a4ab918fbfc1b">   84</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classpsi_1_1ERISieve.html#ac065dcc75f79500d816a4ab918fbfc1b" title="Cutoff values.">sieve_</a>;</div>
<div class="line"><a name="l00086"></a><span class="lineno"><a class="code" href="classpsi_1_1ERISieve.html#a2c4337fc713cce9b342b6e8726fc3920">   86</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classpsi_1_1ERISieve.html#a2c4337fc713cce9b342b6e8726fc3920" title="Maximum |(mn|ls)|.">max_</a>;</div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="code" href="classpsi_1_1ERISieve.html#a9b2ea75c1ca8c44e79c9b6f3074462ee">   88</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classpsi_1_1ERISieve.html#a9b2ea75c1ca8c44e79c9b6f3074462ee" title="sieve_ / max_">sieve_over_max_</a>;</div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="code" href="classpsi_1_1ERISieve.html#a30ad5af2aa5f4fed668e06341872e5c4">   90</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classpsi_1_1ERISieve.html#a30ad5af2aa5f4fed668e06341872e5c4" title="sieve_ * sieve_">sieve2_</a>;</div>
<div class="line"><a name="l00092"></a><span class="lineno"><a class="code" href="classpsi_1_1ERISieve.html#a9370f7dd480a901287512af78e218d9d">   92</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classpsi_1_1ERISieve.html#a9370f7dd480a901287512af78e218d9d" title="sieve_ * sieve_ / max_">sieve2_over_max_</a>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div>
<div class="line"><a name="l00095"></a><span class="lineno"><a class="code" href="classpsi_1_1ERISieve.html#ab96cb748e1b77f53547768c8a96e2c3a">   95</a></span>&#160;    <span class="keywordtype">double</span>* <a class="code" href="classpsi_1_1ERISieve.html#ab96cb748e1b77f53547768c8a96e2c3a" title="|(mn|mn)| values (nbf * nbf)">function_pair_values_</a>;</div>
<div class="line"><a name="l00097"></a><span class="lineno"><a class="code" href="classpsi_1_1ERISieve.html#a0fb94bf381f55b2dffb7ec112c7c72f8">   97</a></span>&#160;    <span class="keywordtype">double</span>* <a class="code" href="classpsi_1_1ERISieve.html#a0fb94bf381f55b2dffb7ec112c7c72f8" title="max |(MN|MN)| values (nshell * nshell)">shell_pair_values_</a>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div>
<div class="line"><a name="l00100"></a><span class="lineno"><a class="code" href="classpsi_1_1ERISieve.html#a0615a7d6c5250956ce50b8a6743ddb2a">  100</a></span>&#160;    std::vector&lt;std::pair&lt;int,int&gt; &gt; <a class="code" href="classpsi_1_1ERISieve.html#a0615a7d6c5250956ce50b8a6743ddb2a" title="Significant unique bra- function pairs, in reduced triangular indexing.">function_pairs_</a>;</div>
<div class="line"><a name="l00102"></a><span class="lineno"><a class="code" href="classpsi_1_1ERISieve.html#a679903beb67dd02eb9a017d8e2a61ba2">  102</a></span>&#160;    std::vector&lt;std::pair&lt;int,int&gt; &gt; <a class="code" href="classpsi_1_1ERISieve.html#a679903beb67dd02eb9a017d8e2a61ba2" title="Significant unique bra- shell pairs, in reduced triangular indexing.">shell_pairs_</a>;</div>
<div class="line"><a name="l00104"></a><span class="lineno"><a class="code" href="classpsi_1_1ERISieve.html#a76892797ce3810ad3e6320a0683ce6c3">  104</a></span>&#160;    std::vector&lt;long int&gt; <a class="code" href="classpsi_1_1ERISieve.html#a76892797ce3810ad3e6320a0683ce6c3" title="Unique bra- function pair indexing, accessed in triangular order, or -1 for non-significant pair...">function_pairs_reverse_</a>;</div>
<div class="line"><a name="l00106"></a><span class="lineno"><a class="code" href="classpsi_1_1ERISieve.html#a23d4a41f357d47cb3e6d76c79a8ffa08">  106</a></span>&#160;    std::vector&lt;long int&gt; <a class="code" href="classpsi_1_1ERISieve.html#a23d4a41f357d47cb3e6d76c79a8ffa08" title="Unique bra- shell pair indexing, accessed in triangular order, or -1 for non-significant pair...">shell_pairs_reverse_</a>;</div>
<div class="line"><a name="l00108"></a><span class="lineno"><a class="code" href="classpsi_1_1ERISieve.html#a462ea1abf98faf01e1ae59812320984f">  108</a></span>&#160;    std::vector&lt;std::vector&lt;int&gt; &gt; <a class="code" href="classpsi_1_1ERISieve.html#a462ea1abf98faf01e1ae59812320984f" title="Significant function pairs, indexes by function.">shell_to_shell_</a>;</div>
<div class="line"><a name="l00110"></a><span class="lineno"><a class="code" href="classpsi_1_1ERISieve.html#a2c24ce418c737a2b4fbbb1e924dd2d5e">  110</a></span>&#160;    std::vector&lt;std::vector&lt;int&gt; &gt; <a class="code" href="classpsi_1_1ERISieve.html#a2c24ce418c737a2b4fbbb1e924dd2d5e" title="Significant shell pairs, indexes by shell.">function_to_function_</a>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="comment">// adding stuff for QQR sieves</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keywordtype">bool</span> do_qqr_;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="comment">// erfc^{-1}(threshold), used in QQR sieving</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="keywordtype">double</span> erfc_thresh_;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="comment">// need an array of extents from the definition</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="comment">// key: how do I efficiently check integrals? without conditional on which</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="comment">// screening I do</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="comment">// 1) just a different function called outside - shell_significant_qqr()</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="comment">// integrals() - fills array of extents</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="comment">// r_{\mu \nu} in QQR paper (eqn. B2)</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  std::vector&lt;Vector3&gt; contracted_centers_;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="comment">// ext&#39;_{\mu \nu} (Eqn. B4)</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="comment">// Extents of contracted charge distributions</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  std::vector&lt;double&gt; extents_;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;     </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classpsi_1_1ERISieve.html#a7441bc3378f51556a5957d855f18b321" title="Set initial indexing.">common_init</a>();</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classpsi_1_1ERISieve.html#a2fc2f0d056dff4cfa9681a5038f2fcb9" title="Compute sieve integrals (only done once)">integrals</a>();</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <a class="code" href="classpsi_1_1ERISieve.html#a61d762c605518c83f5a8b397cfef9a90" title="Constructor, basis set and first sieve cutoff.">ERISieve</a>(<a class="code" href="classboost_1_1shared__ptr.html">boost::shared_ptr&lt;BasisSet&gt;</a> primary, <span class="keywordtype">double</span> <a class="code" href="classpsi_1_1ERISieve.html#a126cbd20766aa7307122207f36b93ece" title="Get sieve cutoff value.">sieve</a> = 0.0);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keyword">virtual</span> <a class="code" href="classpsi_1_1ERISieve.html#ace5874bf33c91a00868d48c66b2ca112" title="Destructor, frees memory.">~ERISieve</a>();</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classpsi_1_1ERISieve.html#a53871c6ed7583019098f42cd60c0029d" title="Set sieve value and redo indexing.">set_sieve</a>(<span class="keywordtype">double</span> <a class="code" href="classpsi_1_1ERISieve.html#a126cbd20766aa7307122207f36b93ece" title="Get sieve cutoff value.">sieve</a>);</div>
<div class="line"><a name="l00153"></a><span class="lineno"><a class="code" href="classpsi_1_1ERISieve.html#a126cbd20766aa7307122207f36b93ece">  153</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classpsi_1_1ERISieve.html#a126cbd20766aa7307122207f36b93ece" title="Get sieve cutoff value.">sieve</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classpsi_1_1ERISieve.html#ac065dcc75f79500d816a4ab918fbfc1b" title="Cutoff values.">sieve_</a>; }</div>
<div class="line"><a name="l00155"></a><span class="lineno"><a class="code" href="classpsi_1_1ERISieve.html#aa18f345c95f64d8aa410634b014574a9">  155</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classpsi_1_1ERISieve.html#aa18f345c95f64d8aa410634b014574a9" title="Global maximum |(mn|rs)|.">max</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classpsi_1_1ERISieve.html#a2c4337fc713cce9b342b6e8726fc3920" title="Maximum |(mn|ls)|.">max_</a>; }</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">// =&gt; Significance Checks &lt;= //</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div>
<div class="line"><a name="l00160"></a><span class="lineno"><a class="code" href="classpsi_1_1ERISieve.html#a00f59f76d381e7aee1ce54ee92c46faf">  160</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classpsi_1_1ERISieve.html#a00f59f76d381e7aee1ce54ee92c46faf" title="Square of ceiling of shell quartet (MN|RS)">shell_ceiling2</a>(<span class="keywordtype">int</span> M, <span class="keywordtype">int</span> N, <span class="keywordtype">int</span> R, <span class="keywordtype">int</span> S) { </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classpsi_1_1ERISieve.html#a0fb94bf381f55b2dffb7ec112c7c72f8" title="max |(MN|MN)| values (nshell * nshell)">shell_pair_values_</a>[N * (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> int) <a class="code" href="classpsi_1_1ERISieve.html#a928519e724dc0980da488a1615ced773" title="Number of shells.">nshell_</a> + M] * </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;               <a class="code" href="classpsi_1_1ERISieve.html#a0fb94bf381f55b2dffb7ec112c7c72f8" title="max |(MN|MN)| values (nshell * nshell)">shell_pair_values_</a>[R * (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>) <a class="code" href="classpsi_1_1ERISieve.html#a928519e724dc0980da488a1615ced773" title="Number of shells.">nshell_</a> + S]; } </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div>
<div class="line"><a name="l00165"></a><span class="lineno"><a class="code" href="classpsi_1_1ERISieve.html#a077b8c81d03b4fdf35650af1dc81ee78">  165</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classpsi_1_1ERISieve.html#a077b8c81d03b4fdf35650af1dc81ee78" title="Square of ceiling of integral (mn|rs)">function_ceiling2</a>(<span class="keywordtype">int</span> m, <span class="keywordtype">int</span> n, <span class="keywordtype">int</span> r, <span class="keywordtype">int</span> s) { </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classpsi_1_1ERISieve.html#ab96cb748e1b77f53547768c8a96e2c3a" title="|(mn|mn)| values (nbf * nbf)">function_pair_values_</a>[m * (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> int) <a class="code" href="classpsi_1_1ERISieve.html#abb4ad4e31527d67a222dd75672d6bb40" title="Number of basis functions.">nbf_</a> + n] * </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;               <a class="code" href="classpsi_1_1ERISieve.html#ab96cb748e1b77f53547768c8a96e2c3a" title="|(mn|mn)| values (nbf * nbf)">function_pair_values_</a>[r * (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>) <a class="code" href="classpsi_1_1ERISieve.html#abb4ad4e31527d67a222dd75672d6bb40" title="Number of basis functions.">nbf_</a> + s]; } </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="comment">//inline bool shell_significant(int M, int N, int R, int S) {</span></div>
<div class="line"><a name="l00172"></a><span class="lineno"><a class="code" href="classpsi_1_1ERISieve.html#a672dd655dc9861852c273aa87826c5a8">  172</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classpsi_1_1ERISieve.html#a672dd655dc9861852c273aa87826c5a8" title="Is the shell quartet (MN|RS) significant according to sieve? (no restriction on MNRS order)...">shell_significant</a>(<span class="keywordtype">int</span> M, <span class="keywordtype">int</span> N, <span class="keywordtype">int</span> R, <span class="keywordtype">int</span> S) {</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      <span class="keywordtype">bool</span> schwarz_bound =  <a class="code" href="classpsi_1_1ERISieve.html#a0fb94bf381f55b2dffb7ec112c7c72f8" title="max |(MN|MN)| values (nshell * nshell)">shell_pair_values_</a>[N * (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> int) <a class="code" href="classpsi_1_1ERISieve.html#a928519e724dc0980da488a1615ced773" title="Number of shells.">nshell_</a> + M] *</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                 <a class="code" href="classpsi_1_1ERISieve.html#a0fb94bf381f55b2dffb7ec112c7c72f8" title="max |(MN|MN)| values (nshell * nshell)">shell_pair_values_</a>[R * (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>) <a class="code" href="classpsi_1_1ERISieve.html#a928519e724dc0980da488a1615ced773" title="Number of shells.">nshell_</a> + S] &gt;= <a class="code" href="classpsi_1_1ERISieve.html#a30ad5af2aa5f4fed668e06341872e5c4" title="sieve_ * sieve_">sieve2_</a>;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      <span class="keywordflow">if</span> (do_qqr_ &amp;&amp; schwarz_bound) {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="keywordtype">bool</span> res = shell_significant_qqr(M, N, R, S);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="comment">//std::cout &lt;&lt; &quot;QQR prune: &quot; &lt;&lt; res &lt;&lt; &quot;\n&quot;;</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      }</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="keywordflow">return</span> schwarz_bound;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      }</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="comment">// Implements the QQR sieve</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordtype">bool</span> shell_significant_qqr(<span class="keywordtype">int</span> M, <span class="keywordtype">int</span> N, <span class="keywordtype">int</span> R, <span class="keywordtype">int</span> S);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  </div>
<div class="line"><a name="l00190"></a><span class="lineno"><a class="code" href="classpsi_1_1ERISieve.html#a0fe932e6569c9abb445d0ee940dfcbd0">  190</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classpsi_1_1ERISieve.html#a0fe932e6569c9abb445d0ee940dfcbd0" title="Is the integral (mn|rs) significant according to sieve? (no restriction on mnrs order)">function_significant</a>(<span class="keywordtype">int</span> m, <span class="keywordtype">int</span> n, <span class="keywordtype">int</span> r, <span class="keywordtype">int</span> s) { </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classpsi_1_1ERISieve.html#ab96cb748e1b77f53547768c8a96e2c3a" title="|(mn|mn)| values (nbf * nbf)">function_pair_values_</a>[m * (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> int) <a class="code" href="classpsi_1_1ERISieve.html#abb4ad4e31527d67a222dd75672d6bb40" title="Number of basis functions.">nbf_</a> + n] * </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;               <a class="code" href="classpsi_1_1ERISieve.html#ab96cb748e1b77f53547768c8a96e2c3a" title="|(mn|mn)| values (nbf * nbf)">function_pair_values_</a>[r * (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>) <a class="code" href="classpsi_1_1ERISieve.html#abb4ad4e31527d67a222dd75672d6bb40" title="Number of basis functions.">nbf_</a> + s] &gt;= <a class="code" href="classpsi_1_1ERISieve.html#a30ad5af2aa5f4fed668e06341872e5c4" title="sieve_ * sieve_">sieve2_</a>; } </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div>
<div class="line"><a name="l00196"></a><span class="lineno"><a class="code" href="classpsi_1_1ERISieve.html#a3a535bba0f4494f88874950efdab4c44">  196</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classpsi_1_1ERISieve.html#a3a535bba0f4494f88874950efdab4c44" title="Is the shell pair (MN| ever significant according to sieve (no restriction on MN order)">shell_pair_significant</a>(<span class="keywordtype">int</span> M, <span class="keywordtype">int</span> N) {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classpsi_1_1ERISieve.html#a0fb94bf381f55b2dffb7ec112c7c72f8" title="max |(MN|MN)| values (nshell * nshell)">shell_pair_values_</a>[M * (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> int) <a class="code" href="classpsi_1_1ERISieve.html#a928519e724dc0980da488a1615ced773" title="Number of shells.">nshell_</a> + N] *</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;               <a class="code" href="classpsi_1_1ERISieve.html#a2c4337fc713cce9b342b6e8726fc3920" title="Maximum |(mn|ls)|.">max_</a> &gt;= <a class="code" href="classpsi_1_1ERISieve.html#a30ad5af2aa5f4fed668e06341872e5c4" title="sieve_ * sieve_">sieve2_</a>; }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div>
<div class="line"><a name="l00201"></a><span class="lineno"><a class="code" href="classpsi_1_1ERISieve.html#a5fdca2167ae4c0e36c334936c4a2aa34">  201</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classpsi_1_1ERISieve.html#a5fdca2167ae4c0e36c334936c4a2aa34" title="Is the function pair (mn| ever significant according to sieve (no restriction on mn order)...">function_pair_significant</a>(<span class="keywordtype">int</span> m, <span class="keywordtype">int</span> n) {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classpsi_1_1ERISieve.html#ab96cb748e1b77f53547768c8a96e2c3a" title="|(mn|mn)| values (nbf * nbf)">function_pair_values_</a>[m * (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> int) <a class="code" href="classpsi_1_1ERISieve.html#abb4ad4e31527d67a222dd75672d6bb40" title="Number of basis functions.">nbf_</a> + n] *</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;               <a class="code" href="classpsi_1_1ERISieve.html#a2c4337fc713cce9b342b6e8726fc3920" title="Maximum |(mn|ls)|.">max_</a> &gt;= <a class="code" href="classpsi_1_1ERISieve.html#a30ad5af2aa5f4fed668e06341872e5c4" title="sieve_ * sieve_">sieve2_</a>; }</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="comment">// =&gt; Indexing [these change after a call to sieve()] &lt;= //</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div>
<div class="line"><a name="l00207"></a><span class="lineno"><a class="code" href="classpsi_1_1ERISieve.html#a2757c009a9b0bef051ea0b30da14c024">  207</a></span>&#160;    <span class="keyword">const</span> std::vector&lt;std::pair&lt;int,int&gt; &gt;&amp; <a class="code" href="classpsi_1_1ERISieve.html#a2757c009a9b0bef051ea0b30da14c024" title="Significant unique bra- function pairs, in reduced triangular indexing.">function_pairs</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classpsi_1_1ERISieve.html#a0615a7d6c5250956ce50b8a6743ddb2a" title="Significant unique bra- function pairs, in reduced triangular indexing.">function_pairs_</a>; }</div>
<div class="line"><a name="l00209"></a><span class="lineno"><a class="code" href="classpsi_1_1ERISieve.html#acd77591e843016a94beaa09a7dc725da">  209</a></span>&#160;    <span class="keyword">const</span> std::vector&lt;std::pair&lt;int,int&gt; &gt;&amp; <a class="code" href="classpsi_1_1ERISieve.html#acd77591e843016a94beaa09a7dc725da" title="Significant unique bra- shell pairs, in reduced triangular indexing.">shell_pairs</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classpsi_1_1ERISieve.html#a679903beb67dd02eb9a017d8e2a61ba2" title="Significant unique bra- shell pairs, in reduced triangular indexing.">shell_pairs_</a>; }</div>
<div class="line"><a name="l00211"></a><span class="lineno"><a class="code" href="classpsi_1_1ERISieve.html#aa814774275391838820f5e5717ab0f9a">  211</a></span>&#160;    <span class="keyword">const</span> std::vector&lt;long int&gt; <a class="code" href="classpsi_1_1ERISieve.html#aa814774275391838820f5e5717ab0f9a" title="Unique bra- function pair indexing, accessed in triangular order, or -1 for non-significant pair...">function_pairs_reverse</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classpsi_1_1ERISieve.html#a76892797ce3810ad3e6320a0683ce6c3" title="Unique bra- function pair indexing, accessed in triangular order, or -1 for non-significant pair...">function_pairs_reverse_</a>; }</div>
<div class="line"><a name="l00213"></a><span class="lineno"><a class="code" href="classpsi_1_1ERISieve.html#aaf6dd0c1e3d0d54c68e150ab59dd8c9c">  213</a></span>&#160;    <span class="keyword">const</span> std::vector&lt;long int&gt; <a class="code" href="classpsi_1_1ERISieve.html#aaf6dd0c1e3d0d54c68e150ab59dd8c9c" title="Unique bra- shell pair indexing, accessed in triangular order, or -1 for non-significant pair...">shell_pairs_reverse</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classpsi_1_1ERISieve.html#a23d4a41f357d47cb3e6d76c79a8ffa08" title="Unique bra- shell pair indexing, accessed in triangular order, or -1 for non-significant pair...">shell_pairs_reverse_</a>; }</div>
<div class="line"><a name="l00215"></a><span class="lineno"><a class="code" href="classpsi_1_1ERISieve.html#a26b1473d210ff9d63ee6b15f26af5a0f">  215</a></span>&#160;    <span class="keyword">const</span> std::vector&lt;std::vector&lt;int&gt; &gt;&amp; <a class="code" href="classpsi_1_1ERISieve.html#a26b1473d210ff9d63ee6b15f26af5a0f" title="Significant function pairs, indexes by function.">function_to_function</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classpsi_1_1ERISieve.html#a2c24ce418c737a2b4fbbb1e924dd2d5e" title="Significant shell pairs, indexes by shell.">function_to_function_</a>; }</div>
<div class="line"><a name="l00217"></a><span class="lineno"><a class="code" href="classpsi_1_1ERISieve.html#a8e4d87e978de2a4222d4e55e9078ca3d">  217</a></span>&#160;    <span class="keyword">const</span> std::vector&lt;std::vector&lt;int&gt; &gt;&amp; <a class="code" href="classpsi_1_1ERISieve.html#a8e4d87e978de2a4222d4e55e9078ca3d" title="Significant shell pairs, indexes by shell.">shell_to_shell</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classpsi_1_1ERISieve.html#a462ea1abf98faf01e1ae59812320984f" title="Significant function pairs, indexes by function.">shell_to_shell_</a>; }</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <span class="comment">//void shell_pair_values(std::vector&lt;std::vector&lt;std::pair&lt;double, int&gt; &gt; &gt;&amp; values) const;</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="comment">// just return the value of the bound for pair m and n</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="keywordtype">double</span> shell_pair_value(<span class="keywordtype">int</span> m, <span class="keywordtype">int</span> n) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  </div>
<div class="line"><a name="l00225"></a><span class="lineno"><a class="code" href="classpsi_1_1ERISieve.html#ac2907a9bfab18f75c34087a7b96ca224">  225</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classpsi_1_1ERISieve.html#ac2907a9bfab18f75c34087a7b96ca224" title="Set debug flag (defaults to 0)">set_debug</a>(<span class="keywordtype">int</span> debug) { <a class="code" href="classpsi_1_1ERISieve.html#a6562cc656efee5e3e425e716a465dc2f" title="Debug flag (defaults to 0)">debug_</a> = debug; }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;};</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;}</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="preprocessor">#endif</span></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.3.1
</small></address>
</body>
</html>
